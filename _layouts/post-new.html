<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <title>{{ page.title }} - {{ site.title }}</title>
    <meta name="description" content="{{ page.description | default: page.excerpt | strip_html | truncate: 160 }}">
    
    <!-- SEO Meta Tags -->
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta property="og:title" content="{{ page.title }}">
    <meta property="og:description" content="{{ page.description | default: page.excerpt | strip_html | truncate: 160 }}">
    <meta property="og:type" content="article">
    <meta property="og:url" content="{{ page.url | absolute_url }}">
    <meta property="og:site_name" content="{{ site.title }}">
    <meta property="og:locale" content="en_US">
    
    <!-- Article specific -->
    <meta property="article:author" content="{{ site.author }}">
    <meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
    {% if page.modified_date %}
    <meta property="article:modified_time" content="{{ page.modified_date | date_to_xmlschema }}">
    {% endif %}
    {% for category in page.categories %}
    <meta property="article:section" content="{{ category }}">
    {% endfor %}
    {% for tag in page.tags %}
    <meta property="article:tag" content="{{ tag }}">
    {% endfor %}
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ page.title }}">
    <meta name="twitter:description" content="{{ page.description | default: page.excerpt | strip_html | truncate: 160 }}">
    
    <!-- Structured data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "headline": "{{ page.title }}",
      "description": "{{ page.description | default: page.excerpt | strip_html | truncate: 160 }}",
      "author": {
        "@type": "Person",
        "name": "{{ site.author }}"
      },
      "datePublished": "{{ page.date | date_to_xmlschema }}",
      {% if page.modified_date %}
      "dateModified": "{{ page.modified_date | date_to_xmlschema }}",
      {% endif %}
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "{{ page.url | absolute_url }}"
      },
      "publisher": {
        "@type": "Organization",
        "name": "{{ site.title }}"
      }
    }
    </script>
    
    <!-- Canonical URL -->
    <link rel="canonical" href="{{ page.url | absolute_url }}">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Prism.js for code highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    
    <!-- Post CSS -->
    <link rel="stylesheet" href="{{ '/assets/css/post.css' | relative_url }}">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MLB32YW721"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      
      // Initialize with denied consent
      gtag('consent', 'default', {
        'analytics_storage': 'denied'
      });
      
      gtag('js', new Date());
      gtag('config', 'G-MLB32YW721');
    </script>
  </head>
  
  <body>
    <!-- Header -->
    <header class="post-header">
      <nav class="post-nav">
        <div class="nav-container">
          <a href="/" class="nav-home">← Home</a>
          <a href="/blog" class="nav-blog">← Blog</a>
        </div>
      </nav>
    </header>

    <!-- Main Content -->
    <main class="post-main">
      <article class="post-article">
        <!-- Post Header -->
        <header class="article-header">
          <div class="article-meta">
            <time class="article-date" datetime="{{ page.date | date_to_xmlschema }}">
              {{ page.date | date: "%B %d, %Y" }}
            </time>
            {% if page.reading_time %}
            <span class="reading-time">{{ page.reading_time }} min read</span>
            {% endif %}
          </div>
          
          <h1 class="article-title">{{ page.title }}</h1>
          
          {% if page.subtitle %}
          <p class="article-subtitle">{{ page.subtitle }}</p>
          {% endif %}
          
          {% if page.categories.size > 0 %}
          <div class="article-categories">
            {% for category in page.categories %}
            <span class="category-tag">{{ category }}</span>
            {% endfor %}
          </div>
          {% endif %}
        </header>

        <!-- Post Content -->
        <div class="article-content">
          {{ content }}
        </div>

        <!-- Post Footer -->
        <footer class="article-footer">
          {% if page.tags.size > 0 %}
          <div class="article-tags">
            <span class="tags-label">Tags:</span>
            {% for tag in page.tags %}
            <span class="tag">{{ tag }}</span>
            {% endfor %}
          </div>
          {% endif %}
          
          <div class="article-share">
            <span class="share-label">Share:</span>
            <a href="https://twitter.com/intent/tweet?text={{ page.title | uri_escape }}&url={{ page.url | absolute_url | uri_escape }}" 
               target="_blank" class="share-link twitter">Twitter</a>
            <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ page.url | absolute_url | uri_escape }}" 
               target="_blank" class="share-link linkedin">LinkedIn</a>
          </div>
        </footer>
      </article>

      <!-- Navigation between posts -->
      <nav class="post-navigation">
        {% if page.previous.url %}
        <a href="{{ page.previous.url | relative_url }}" class="nav-previous">
          <span class="nav-label">← Previous</span>
          <span class="nav-title">{{ page.previous.title }}</span>
        </a>
        {% endif %}
        
        {% if page.next.url %}
        <a href="{{ page.next.url | relative_url }}" class="nav-next">
          <span class="nav-label">Next →</span>
          <span class="nav-title">{{ page.next.title }}</span>
        </a>
        {% endif %}
      </nav>

      <!-- Back to blog -->
      <div class="back-to-blog">
        <a href="/blog" class="back-link">← Back to all posts</a>
      </div>
    </main>

    <!-- Prism.js for code highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <!-- Cookie Management -->
    {% include cookie-banner.html %}
    <script src="{{ '/assets/js/cookies.js' | relative_url }}"></script>
  </body>
</html>
